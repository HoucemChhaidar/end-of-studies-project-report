% Suppress warnings for cleaner compile log
\usepackage{silence}
\WarningsOff*

%==============================================================================%
%                                  Page Setup                                  %
%==============================================================================%

\usepackage[a4paper,left=2.5cm,right=2.5cm,top=2.5cm,bottom=2.5cm]{geometry}
\usepackage{environ}
\usepackage{needspace}
\usepackage{pdfpages}

%==============================================================================%
%                              Language & Encoding                             %
%==============================================================================%

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}
\usepackage{varioref}

%==============================================================================%
%                                    Colors                                    %
%==============================================================================%

\usepackage{xcolor}
\definecolor{linkcolor}{RGB}{31, 78, 121}
\definecolor{citecolor}{RGB}{31, 78, 121}
\definecolor{urlcolor}{RGB}{31, 78, 121}
\definecolor{tableRow1}{RGB}{210,234,241}
\definecolor{gray75}{gray}{0.75}
\definecolor{reportType}{HTML}{013873}

%==============================================================================%
%                               Font & Typography                              %
%==============================================================================%

% Set Times New Roman as default font
\def\defaultFont{ptm}
\renewcommand*{\familydefault}{\defaultFont}

% Set base font size to 12pt
\renewcommand{\normalsize}{\fontsize{12}{14.4}\selectfont}

% Line spacing and paragraph settings
\usepackage{setspace}
\setstretch{1.5}
\setlength{\parskip}{1ex}
\setlength{\parindent}{0pt}

% Prevent hyphenation and widow/orphan lines
\hyphenpenalty=10000
\exhyphenpenalty=10000
\usepackage[all]{nowidow}
\clubpenalty=10000
\widowpenalty=10000
\brokenpenalty=10000
\predisplaypenalty=10000
\postdisplaypenalty=10000
\displaywidowpenalty=10000

%==============================================================================%
%                           Section & Chapter Formatting                       %
%==============================================================================%

\usepackage[explicit]{titlesec}

% Chapter title formatting variables
\newlength\BoxWd \setlength\BoxWd{10mm}
\newlength\Aux

% Numbered chapters
\titleformat{\chapter}[display]%
    {\fontsize{26}{6}\bfseries\selectfont%
      \settowidth\Aux{\textcolor{white}{\Huge\thechapter}}%
      \ifnum\Aux>\BoxWd%
        \setlength\BoxWd{\Aux}%
      \else\fi%
    }%
    {%
      {\hspace*{-1.5mm}\normalfont\fontsize{14}{6}\selectfont{Chapter}}\\%
      \colorbox{black}{%
        \parbox[c][20mm][t]{\BoxWd}{%
          \vspace{2.5mm}\centering\textcolor{white}{\Huge\thechapter}%
        }%
      }%
    }%
    {-10mm}%
    {%
      \vspace{-5mm}\hspace*{15mm}\titlerule\\\\\hspace*{15mm}#1%
    }

% Unnumbered chapters
\titleformat{name=\chapter, numberless}[display]%
    {\fontsize{26}{6}\bfseries\selectfont%
      \settowidth\Aux{\textcolor{white}{\Huge\thechapter}}%
      \ifnum\Aux>\BoxWd%
        \setlength\BoxWd{\Aux}%
      \else\fi%
    }%
    {%
      {\hspace*{-1.5mm}\normalfont\fontsize{14}{6}\selectfont{~}}\\%
      \colorbox{black}{%
        \parbox[c][20mm][t]{\BoxWd}{%
          \vspace{2.5mm}\centering\textcolor{white}{~}%
        }%
      }%
    }%
    {-10mm}%
    {%
      \vspace{-5mm}\hspace*{15mm}\titlerule\\\\\hspace*{15mm}#1%
    }

\titlespacing*{\chapter}{0pt}{0pt}{50pt}

% Section formatting
\titleformat{\section}[block]%
  {\Large\bfseries}{\thesection}%
  {10pt}{\Large{\bfseries{#1}}}

\titleformat{\subsection}[block]
  {\large\bfseries}{\thesubsection}
  {10pt}{\large{\bfseries{#1}}}

\titleformat{\subsubsection}[block]
  {\normalsize\bfseries}{\thesubsubsection}
  {10pt}{\normalsize{\bfseries{#1}}}

\titleformat{\paragraph}[block]%
  {\normalfont\normalsize\bfseries}%
  {\theparagraph}{1em}{#1}%

%==============================================================================%
%                               Headers & Footers                              %
%==============================================================================%

\usepackage{fancyhdr}
\setlength{\fboxsep}{0mm}

% Custom page style for front matter
\fancypagestyle{MyStyle}{
  \renewcommand{\headrulewidth}{0pt}
  \renewcommand{\footrulewidth}{0.5pt}
  \fancyhead[L]{}
  \fancyfoot[R]{\fontsize{12}{12}\selectfont Page \thepage}
  \fancyfoot[L]{\fontsize{12}{12}\selectfont IIT}
}

% Default page style
\fancypagestyle{plain}{
  \fancyhf{}
  \renewcommand{\headrulewidth}{0.5pt}
  \renewcommand{\footrulewidth}{0.5pt}
  \fancyhead[L]{\fontsize{12}{12}\selectfont\textsc{\MakeLowercase{\leftmark}}}
  \fancyfoot[R]{\fontsize{12}{12}\selectfont Page \thepage}
  \fancyfoot[L]{\fontsize{12}{12}\selectfont\ IIT}
}
\pagestyle{plain}

\renewcommand{\chaptermark}[1]{\markboth{\MakeUppercase{#1}}{}}
\renewcommand{\sectionmark}[1]{\markright{#1}}

%==============================================================================%
%                               Graphics & Figures                             %
%==============================================================================%

\usepackage{graphicx}
\usepackage{float}
\graphicspath{{images/}}
\usepackage{subcaption}
\usepackage[export]{adjustbox}
\usepackage{tikz}
\usepackage{wrapfig}

%==============================================================================%
%                               Caption Formatting                             %
%==============================================================================%

\usepackage{caption}
\captionsetup{
    labelfont=bf,
    font={singlespacing},
    justification=RaggedRight,
    font=small,
    textfont={bf},
    labelsep=period
}
\addto\captionsenglish{%
  \renewcommand{\listtablename}{LIST OF TABLES}%
  \renewcommand{\listfigurename}{LIST OF FIGURES}%
}

%==============================================================================%
%                                    Tables                                    %
%==============================================================================%

\usepackage{array,ragged2e}
\usepackage{longtable}
\usepackage{multirow}
\usepackage[table]{xcolor}
\usepackage{tabularx}
\usepackage{ctable}

%==============================================================================%
%                                     Lists                                    %
%==============================================================================%

\usepackage{enumitem}
\setlist[enumerate]{itemsep=-0.35\baselineskip}

%==============================================================================%
%                                  Hyperlinks                                  %
%==============================================================================%

\usepackage[
    hidelinks,
    pdfauthor={Houcem Chhaidar},
    pdftitle={End of Studies Project Report},
    pdfsubject={Flutter + Spring Boot POS System},
    pdfkeywords={Flutter, Spring Boot, POS, Tunisia, Thesis}
]{hyperref}

\newcommand{\ignore}[2]{\hspace{0mm}#2}
\renewcommand{\UrlFont}{\ignore{Actually do nothing!}}

%==============================================================================%
%                                   Footnotes                                  %
%==============================================================================%

\usepackage[bottom]{footmisc}
\renewcommand{\footnotesize}{\fontsize{10}{11}\selectfont}
\renewcommand{\footnoterule}{\vspace*{1ex}\noindent\rule{2.5cm}{0.4pt}\vspace*{1ex}}
\counterwithout{footnote}{chapter}

%==============================================================================%
%                             Mini Table of Contents                           %
%==============================================================================%

\usepackage[english]{minitoc}
\mtcsettitle{minitoc}{Chapter Plan}
\setcounter{minitocdepth}{2}

\renewcommand{\mtcfont}{\normalsize\bfseries}
\renewcommand{\mtcSfont}{\normalsize\bfseries}
\setlength{\mtcindent}{15pt}

\renewcommand{\mtcgapbeforeheads}{0pt}
\renewcommand{\mtcgapafterheads}{0pt}
\setlength{\mtcskipamount}{0pt}

\renewcommand{\mtcfont}{\normalsize\bfseries\linespread{1}\selectfont}
\renewcommand{\mtcSfont}{\normalsize\bfseries\linespread{1}\selectfont}

%==============================================================================%
%                             Counters & Numbering                             %
%==============================================================================%

\setcounter{secnumdepth}{5}
\setcounter{tocdepth}{3}
\renewcommand\theparagraph{\alph{paragraph})}
\renewcommand\thesubparagraph{\roman{subparagraph}).}

%==============================================================================%
%                                 Float Settings                               %
%==============================================================================%

\renewcommand\floatpagefraction{0.8}

%==============================================================================%
%                                 Miscellaneous                                %
%==============================================================================%

\usepackage[skins]{tcolorbox}
\usepackage{afterpage}
\usepackage{pifont}
\usepackage{minted}
\usepackage{seqsplit}
\usepackage[titletoc,title]{appendix}
\usepackage{lettrine}
\usepackage{lmodern}

%==============================================================================%
%                                Custom Commands                               %
%==============================================================================%

\newcommand{\HRule}[1][\linewidth]{%
  \rule{#1}{0.5mm}%
}